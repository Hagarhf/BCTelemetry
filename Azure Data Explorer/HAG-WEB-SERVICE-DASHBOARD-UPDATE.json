{
  "note": "Add this tile and query to BCTelemetryDashboard.json",
  "instructions": {
    "step1": "Add the tile below to the 'tiles' array (after the last Hagar Extensions tile)",
    "step2": "Add the query below to the 'queries' array (before the closing bracket)"
  },
  "tile_to_add": {
    "id": "e9f0a1b2-c3d4-4567-8901-234567bcdef7",
    "title": "HAG Web Service API (Page 80107)",
    "visualType": "table",
    "pageId": "f4a5b6c7-d8e9-4012-3456-789012abcdef",
    "layout": {
      "x": 0,
      "y": 22,
      "width": 24,
      "height": 8
    },
    "queryRef": {
      "kind": "query",
      "queryId": "d9e0f1a2-b3c4-4678-9012-345678bcdef8"
    },
    "visualOptions": {
      "table__enableRenderLinks": true,
      "colorRulesDisabled": false,
      "colorStyle": "light",
      "crossFilterDisabled": false,
      "drillthroughDisabled": false,
      "crossFilter": [],
      "drillthrough": [],
      "table__renderLinks": [],
      "colorRules": []
    }
  },
  "query_to_add": {
    "dataSource": {
      "kind": "inline",
      "dataSourceId": "05ae5610-5603-45ac-9458-616539c1c150"
    },
    "text": "let TimeRange = 24h;\ntraces\n| where timestamp > ago(TimeRange)\n| extend\n    alObjectId = tostring(customDimensions.alObjectId),\n    alObjectName = tostring(customDimensions.alObjectName)\n| where alObjectId == \"80107\"\n| extend executionTimeMs = toreal(totimespan(customDimensions.serverExecutionTime))/10000\n| summarize\n    CallCount = count(),\n    AvgMs = round(avg(executionTimeMs), 2),\n    P95Ms = round(percentile(executionTimeMs, 95), 2),\n    MaxMs = round(max(executionTimeMs), 2),\n    ErrorCount = countif(severityLevel >= 3),\n    LastCall = max(timestamp)\n    by bin(timestamp, 1h)\n| extend MinutesSinceLastCall = datetime_diff('minute', now(), LastCall)\n| extend\n    PerformanceStatus = case(\n        AvgMs > 1000, \"üî¥ Slow (>1s)\",\n        AvgMs > 500, \"‚ö†Ô∏è Moderate (500ms-1s)\",\n        \"‚úÖ Fast (<500ms)\"\n    ),\n    HealthStatus = case(\n        ErrorCount > 0, \"üî¥ Has Errors\",\n        MinutesSinceLastCall > 60, \"‚ö†Ô∏è Inactive >1h\",\n        \"‚úÖ Healthy\"\n    )\n| project\n    timestamp,\n    CallCount,\n    AvgMs,\n    P95Ms,\n    MaxMs,\n    ErrorCount,\n    PerformanceStatus,\n    HealthStatus,\n    LastCall\n| order by timestamp desc",
    "id": "d9e0f1a2-b3c4-4678-9012-345678bcdef8",
    "usedVariables": []
  }
}
